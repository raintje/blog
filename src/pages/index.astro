---
import { Rss } from '@lucide/astro';

import { getCollection } from 'astro:content';

import Hero from '$/components/hero.astro';
import BlogPostCard from '$/components/blog-post-card.astro';

import Skeleton from '$/layouts/skeleton.astro';

import { cn } from '$/lib/cn';
import { slugify } from '$/lib/slugify';

import GithubIcon from '$/assets/icons/github.svg';
import Footer from '$/components/footer.astro';

const posts = await getCollection('blog', ({ data }) => !data.draft);
---

<Skeleton title="Home" description="The home page of the blog.">
  <Hero>
    <span slot="heading">Observations of a scatterbrain</span>
    <span slot="content">
      Hello, my name is Wessel. I'm a software engineer with a passion for writing software that feels both good to
      develop, and good to use. On this blog you'll mostly find my thoughts on anything and everything. Music,
      literature, video games and maybe even the occasional post about software development.
    </span>
    <div class={cn('mt-4', 'flex', 'items-center', 'gap-2', 'text-xs', 'md:text-sm')}>
      Check me out on:
      <a href="https://github.com/raintje" class={cn('hover:cursor-pointer', 'hover:text-accent')}>
        <span class={cn('sr-only')}>GitHub</span>
        <GithubIcon class={cn('size-6', 'stroke-current', 'transition-all', 'duration-100')} />
      </a>
      <a href={new URL('rss.xml', import.meta.env.PUBLIC_SITE)} class={cn('hover:cursor-pointer', 'hover:text-accent')}>
        <span class={cn('sr-only')}>RSS feed</span>
        <Rss />
      </a>
    </div>
  </Hero>
  <div class={cn('my-4')}>
    <h2 class={cn('text-lg', 'md:text-xl', 'font-semibold', 'my-2', 'md:my-4')}>Recent Posts</h2>
    {posts.map((p) => <BlogPostCard href={`/blog/${slugify(p.data.title)}`} frontmatter={p.data} />)}
  </div>
  <Footer slot={'footer'} marginTop />
</Skeleton>
